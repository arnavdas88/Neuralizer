<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neuralizer</title>


    <script type='text/javascript' src='http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG'></script>
    <!--jQuery-->
    <script src="js/jquery-3.0.0.min.js"></script>
    <!-- bootstrap -->
    <link href="css/bootstrap-glyphicons.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- bootstrap select -->
    <link rel="stylesheet" href="css/bootstrap-select.css"> <!-- js is at the end -->
    <!--Pulling Awesome Font -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- style -->
    <link href="https://fonts.googleapis.com/css?family=Lato:100,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
          rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/social.css" rel="stylesheet">
    <link href="css/keys.css" rel="stylesheet">
    <!-- neuralizer scripts -->
    <script src="js/utils.js"></script>
    <script src="js/shapes.js"></script>
    <script src="js/objects.js"></script>
    <script src="js/nn.js"></script>
    <script src="js/transforms.js"></script>
    <script src="js/files.js"></script>
    <script src="js/canvas_manager.js"></script>
    <script src="js/side_bar_manager.js"></script>
    <!-- favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="images/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      displayAlign: "left",
      displayIndent: "2em",
      SVG: { scale: 120 }
    });
    </script>

    <script type="text/javascript">

        var canvas_manager;
        var sidebar_manager;

        var layer_types = {
            "DataPlaceholder": {
                "id": "#dataParams",
                "short_name": "data"
            },
            "Pooling": {
                "id": "#poolingParams",
                "short_name": "pool",
                "subtype_selector_id": "#poolingType",
                "subtypes": {"MaxPooling": {"id": "#maxPoolingParams"},
                             "AveragePooling": {"id": "#averagePoolingParams"},
                             "StochasticPooling": {"id": "#stochasticPoolingParams"}}},
            "Convolution": {
                "id": "#convolutionParams",
                "short_name": "conv"},
            "Deconvolution": {
                "id": "#deconvolutionParams",
                "short_name": "deconv"},
            "Activation": {
                "id": "#activationParams",
                "short_name": "activation",
                "subtype_selector_id": "#activationType",
                "subtypes": {"ReLU": {"id": "#reluParams"},
                             "ReLU6": {"id": "#relu6Params"},
                             "LeakyReLU": {"id": "#leakyReluParams"},
                             "ParametericReLU": {"id": "#parametericReluParams"},
                             "ELU": {"id": "#eluParams"},
                             "Sigmoid": {"id": "#sigmoidParams"},
                             "HardSigmoid": {"id": "#hardSigmoidParams"},
                             "TanH": {"id": "#tanhParams"},
                             "Softmax": {"id": "#softmaxParams"},
                             "Softsign": {"id": "#softsignParams"},
                             "Softplux": {"id": "#softplusParams"}}},
            "Normalization": {
                "id": "#normalizationParams",
                "short_name": "norm",
                "subtype_selector_id": "#normalizationType",
                "subtypes": {"LocalResponseNormalization": {"id": "#localResponseNormalizationParams"},
                             "BatchNormalization": {"id": "#batchNormalizationParams"},
                             "L2Normalization": {"id": "#l2NormalizationParams"}}},
            "Regularization": {
                "id": "#regularizationParams",
                "short_name": "regularize",
                "subtype_selector_id": "#regularizationType",
                "subtypes": {"Dropout": {"id": "#dropoutParams"},
                             "Maxout": {"id": "#maxoutParams"},
                             "Zoneout": {"id": "#zoneoutParams"},
                             "DropConnect": {"id": "#dropConnectParams"}}},
            "DataManipulation": {
                "id": "#dataManipulationParams",
                "short_name": "manipulate",
                "subtype_selector_id": "#dataManipulationType",
                "subtype": {"Reshape": {"id": "#reshapeParams"},
                            "Concatenate": {"id": "#concatenateParams"},
                            "Flatten": {"id": "#flattenParams"},
                            "Permute": {"id": "#permuteParams"}}},
            "ElementWise": {
                "id": "#elementWiseParams",
                "short_name": "+",
                "subtype_selector_id": "#elementWiseType",
                "subtype": {"Add": {"id": "#addParams"},
                            "Multiply": {"id": "#multiplyParams"}}},
            "Stochastic": {
                "id": "#stochasticParams",
                "short_name": "stochastic",
                "subtype": {"GaussianNoise": {"id": "#gaussianParams"},
                            "UniformNoise": {"id": "#uniformParams"},
                            "GumbleSoftmax": {"id": "#gumbleSoftmaxParams"}}},
            "InnerProduct": {"id": "#innerProductParams", "short_name": "fc"},
            "SpecialBlock": {"id": "#specialBlockParams", "short_name": "special"},
            "Recurrent": {"id": "#recurrentParams", "short_name": "recurrent"},
            "Advanced": {
                "id": "#advancedParams",
                "short_name": "advanced",
                "subtype": {"Memory": {"id": "#memoryParams"},
                            "Attention": {"id": "#attentionParams"}}}
        };

        function send_email() {
            var body = JSON.stringify(canvas_manager.stored_states[canvas_manager.current_timestep]);
            var subject = "Neuralizer Topology";
            window.open('mailto:'  + '?subject=' +subject + '&body=' + body);
        }

        function change_color(color_idx) {
            canvas_manager.change_selected_shapes_color(color_idx);
            sidebar_manager.change_selected_color(color_idx);
        }

        function switch_layer_type(layerType, layerSubtype) {
            var key;
            // close all other than the given type
            for (key in layer_types) {
                if (layerType == key) {
                    $(layer_types[key]["id"]).show("fast");
                } else {
                    $(layer_types[key]["id"]).hide("fast");
                }
            }

            // choose subtype
            for (key in layer_types[layerType]["subtypes"]) {
                if (layerSubtype == key) {
                    $(layer_types[layerType]["subtypes"][key]["id"]).show("fast");
                } else {
                    $(layer_types[layerType]["subtypes"][key]["id"]).hide("fast");
                }
            }
        }

        function select_layer_type() {
            // open the parameters section for the selected layer type only
            var layerType = $("#layerType").val();
            var layerSubtype = $(layer_types[layerType]["subtype_selector_id"]).val();
            switch_layer_type(layerType, layerSubtype);
        }

        function change_selected_layer_type(layerType, layerSubtype) {
            $("#layerType").val(layerType);
            $(layer_types[layerType]["subtype_selector_id"]).val(layerSubtype);
        }

        function create_new_layer() {
            var layerType = $("#layerType").val();
            var layer;
            if (layerType == "Convolution") {
                layer = new Convolution($("#numOfms").val(),$("#kernelWidth").val(),$("#kernelHeight").val(),$("#kernelStride").val(),$("#kernelStride").val(),0,0);
            } else if (layerType == "InnerProduct") {
                layer = new InnerProduct($("#innerProductNumOutputs").val());
            } else if (layerType == "Pooling") {
                layer = new Pooling($("#windowWidth").val(),$("#windowHeight").val(),$("#windowStride").val(),$("#windowStride").val(),0,0,$("#poolingType").val());
            } else if (layerType == "Deconvolution") {
                layer = new Deconvolution($("#numOfms").val(),$("#kernelWidth").val(),$("#kernelHeight").val(),$("#kernelStride").val(),$("#kernelStride").val(),0,0);
            } else if (layerType == "Activation") {

            } else if (layerType == "Normalization") {
                var normalizationType = $("#normalizationType").val();
                if (normalizationType == "LocalResponseNormalization") {
                    layer = new LRN($("#numberOfNeighbours").val(), $("#K").val(),$("#alpha").val(),$("#beta").val());
                } else if (normalizationType == "BatchNormalization") {
                    layer = new BatchNormalization();
                }
            } else if (layerType == "Noise") {

            } else if (layerType == "Recurrent") {

            } else {
                layer = new Layer();
            }
            return layer;
        }

        function get_short_name(layer_type) {
            // get a short default name for a layer
            if (layer_types[layer_type] != undefined) {
                return layer_types[layer_type]["short_name"];
            }
            return "";
        }


        function update_shape_name() {
            canvas_manager.get_primary_selected_shape().update_text($("#layerName").val());
            canvas_manager.draw_required = true;
            canvas_manager.draw_curr_state_if_necessary();
        }


        function add_layer() {
            canvas_manager.reset_selected_shapes();
            canvas_manager.mouse_is_pressed = true;

            var layer_type = $("#layerType").val();
            var layer_name = $("#layerName").val();
            if (layer_name == "") {
                layer_name = get_short_name(layer_type);
                $("#layerName").val(layer_name);
            }

            var x = canvas_manager.cursor_x;
            var y = canvas_manager.cursor_y;
            var color = canvas_manager.selected_color_idx;
            var shape;
            if (layer_type == "DataPlaceholder") {
                shape = new Rectangle(x - 40, y - 20, 80, 40, 3, 10, 3, layer_name, fill_colors[color], border_colors[color], false);
            } else if (layer_type == "DataManipulation") {
                shape = new Triangle(x - 20, y - 20, 40, 40, 2, 3, fill_colors[color], border_colors[color]);
            } else if (layer_type == "ElementWise") {
                shape = new Circle(x - 20, y - 20, 20, 3, layer_name, fill_colors[color], border_colors[color]);
            } else {
                shape = new Rectangle(x - 40, y - 20, 80, 40, 10, 0, 3, layer_name, fill_colors[color], border_colors[color], false);
            }
            shape.set_layer(create_new_layer());
            canvas_manager.add_shape(shape);
        }

        function add_or_remove_layer() {
            if ($("#addLayerIcon").hasClass('rotated')) {
                canvas_manager.remove_selected_shapes();
            } else {
                add_layer();
            }
            sidebar_manager.toggle_add_or_remove_button();
        }



        function run() {
            canvas_manager = new CanvasManager(document.getElementById('cnv'));
            sidebar_manager = new SidebarManager();


            function mouseDown(evt) {
                canvas_manager.hide_selection_box();
                canvas_manager.update_cursor_state(evt.clientX, evt.clientY, evt.button, true);

                if (canvas_manager.shape_with_content_pointed_by_cursor) {
                    if (!canvas_manager.shape_is_selected(canvas_manager.shape_with_content_pointed_by_cursor)) {
                        // select the currently pointed shape if it not already selected
                        canvas_manager.select_shape(canvas_manager.shape_with_content_pointed_by_cursor);
                    }
                } else if (canvas_manager.pressed_mouse_button == "left") {
                    // add points to curr arrow or attach / detach an arrow
                    canvas_manager.extend_current_arrow();
                    canvas_manager.reset_selected_shapes();
                }

                // sidebar add/remove button toggle
                if (canvas_manager.selected_shapes.length == 0) {
                    canvas_manager.initialize_selection_box();
                    sidebar_manager.set_add_or_remove_button_to_add();
                } else {
                    sidebar_manager.set_add_or_remove_button_to_remove();
                }

                // update side bar properties
                var selected_shape = canvas_manager.get_primary_selected_shape();
                if (selected_shape) {
                    sidebar_manager.set_layer_name(selected_shape.text);
                    sidebar_manager.change_selected_color(canvas_manager.get_shape_color_idx(selected_shape));
                } else {
                    sidebar_manager.set_layer_name("");
                }
                sidebar_manager.focus_layer_name();

                // draw
                canvas_manager.draw_curr_state_if_necessary();
            }


            function mouseMove(evt) {
                $('body').css('cursor', 'default');
                canvas_manager.update_cursor_state(evt.clientX, evt.clientY, evt.button);

                if (canvas_manager.mouse_is_pressed && canvas_manager.current_arrow.points == 0) {
                    if (!canvas_manager.get_primary_selected_shape() || canvas_manager.selection_box_is_active()) {
                        canvas_manager.set_selection_box();
                        if (canvas_manager.get_primary_selected_shape()) {
                            sidebar_manager.set_add_or_remove_button_to_remove();
                        }
                    }
                }

                if (canvas_manager.shape_with_content_pointed_by_cursor) {
                    $('body').css('cursor', 'move');
                } else if (canvas_manager.get_object_with_pointed_border()) {
                    $('body').css('cursor', 'pointer');
                }

                canvas_manager.highlight_selected_shapes();

                if (canvas_manager.mouse_is_pressed && canvas_manager.pressed_mouse_button == "left" && !canvas_manager.selection_box_is_active()) {
                    canvas_manager.move_selected_shapes();
                }

                if (canvas_manager.current_arrow.vertices.length > 0) {
                    canvas_manager.current_arrow.add_point(new Vertex(canvas_manager.cursor_x, canvas_manager.cursor_y, 0));
                }

                canvas_manager.draw_curr_state_if_necessary();
            }

            function mouseUp(evt) {
                canvas_manager.hide_selection_box();

                canvas_manager.update_cursor_state(evt.clientX, evt.clientY, evt.button, false);

                // just for moving all lines to the correct place
                canvas_manager.move_shapes(canvas_manager.shapes, 0, 0);

                canvas_manager.save_state();
            }

            function keyPress(evt) {
                evt = evt || window.event;
                if (evt.keyCode == 46) {
                    // Del ==> Remove selected layers
                    if ($("#addLayerIcon").hasClass('rotated')) {
                        canvas_manager.remove_selected_shapes();
                        sidebar_manager.toggle_add_or_remove_button();
                        canvas_manager.draw_required = true;
                    }
                } else if (evt.ctrlKey && evt.keyCode == 65) {
                    // Ctrl + A ==> Select all
                    canvas_manager.select_all_shapes();
                    sidebar_manager.set_add_or_remove_button_to_remove();
                    evt.preventDefault();
                    evt.stopPropagation();
                } else if (evt.ctrlKey && evt.keyCode == 67) {
                    // Ctrl + C ==> Copy
                    canvas_manager.show_message("Copied to clipboard");
                    canvas_manager.copy_from_clipboard();
                    $("#layerName").blur();
                } else if (evt.ctrlKey && evt.keyCode == 86) {
                    // Ctrl + V ==> Paste
                    canvas_manager.paste_from_clipboard();
                } else if (evt.ctrlKey && evt.keyCode == 90 && !evt.shiftKey) {
                    // Ctrl + Z ==> undo
                    if (canvas_manager.undo()) {
                        canvas_manager.show_message("Undo changes");
                    }
                } else if ((evt.ctrlKey && evt.keyCode == 89) || (evt.ctrlKey && evt.shiftKey && evt.keyCode == 90)) {
                    // Ctrl + Y ==> redo
                    if (canvas_manager.redo()) {
                        canvas_manager.show_message("Redo changes");
                        canvas_manager.highlight_selected_shapes();
                    }
                } else if (evt.keyCode == 27) {
                    // Escape ==> Cancel current action
                    canvas_manager.reset_current_arrow();
                } else if (evt.keyCode == 8) {
                    // Backspace ==> Cancel last arrow point
                    if (canvas_manager.current_arrow.points > 0) {
                        canvas_manager.current_arrow.vertices.pop();
                        canvas_manager.current_arrow.points--;
                        canvas_manager.draw_required = true;
                    }
                } else if (evt.ctrlKey && evt.keyCode == 88) {
                    // Ctrl + X ==> Printing graph test
                    console.log(canvas_manager.to_graph());
                }
                canvas_manager.draw_curr_state_if_necessary();
            }

            // event listeners
            canvas_manager.canvas.addEventListener('mousedown', mouseDown);
            document.addEventListener('mousemove', mouseMove);
            document.addEventListener('mouseup', mouseUp);
            document.addEventListener('keydown', keyPress);
            window.addEventListener('resize', function() { canvas_manager.fix_canvas_size(document.getElementById('cnv')) });
            var fileInput = document.getElementById('fileInput');
            fileInput.addEventListener('change', load_state_from_file);
        }
    </script>
</head>
<body onload="run()" style="overflow: hidden;" oncontextmenu="return false">
<!-- Github Form Me Ribbon -->
<a href="https://github.com/itaicaspi/Neuralizer">
    <img style="z-index: 10; position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png">
</a>
<!--------------------------->

<div class="col-xs-1 icons-side-bar">
    <div class="wrapping-side-icon" style="height: 100px;">
        <div id="before_icon" class="side-icon before-side-icon" style="height: 100px; cursor: default">
        </div>
    </div>
    <!-- Designer -->
    <div>
        <div id="designer_icon" class="side-icon selected-side-icon" onclick="sidebar_manager.switch_sidebar_mode('designer')">
            <i data-toggle="tooltip" data-placement="top" title="Designer" class="material-icons">color_lens</i>
        </div>
    </div>
    <!-- Import / Export -->
    <div class="wrapping-side-icon">
        <div id="import_export_icon" class="side-icon after-side-icon" onclick="sidebar_manager.switch_sidebar_mode('import_export')">
            <i data-toggle="tooltip" data-placement="top" title="Import/Export" class="material-icons">file_download</i>
        </div>
    </div>
    <!-- Share -->
    <!--<div>-->
        <!--<div id="share_icon" class="side-icon" onclick="sidebar_manager.switch_sidebar_mode('share')">-->
            <!--<i data-toggle="tooltip" data-placement="top" title="Share" class="material-icons">share</i>-->
        <!--</div>-->
    <!--</div>-->
    <!-- Share / Explore -->
    <div>
        <div id="share_explore_icon" class="side-icon" onclick="sidebar_manager.switch_sidebar_mode('share_explore')">
            <i data-toggle="tooltip" data-placement="top" title="Share/Explore" class="material-icons">explore</i>
        </div>
    </div>
    <!-- Account -->
    <div>
        <div id="account_icon" class="side-icon" onclick="sidebar_manager.switch_sidebar_mode('account')">
            <i data-toggle="tooltip" data-placement="top" title="Account" class="material-icons">account_circle</i>
        </div>
    </div>
    <div style="height: 100px;">
        <div id="after_icon" class="side-icon" style="height:100px; cursor: default">
        </div>
    </div>
</div>
<div class="col-xs-2 divContainer side-bar">
    <div class="appName">
        <h1>neuralizer</h1>
        <b style="font-size: 17px;text-align: center;">visual neural network designer</b>
    </div>
    <br>
    <div id="designer">
        <div class="form-group">
            <label for="layerName" style="color:white">Layer Name</label>
            <!-- Latex support -->
            <!--
            <div class="material-switch pull-right">
                <span style="padding-right: 5px;"><img src="images/latex.png" height="17px"></span>
                <input id="latexName" name="latexName" type="checkbox" />
                <label for="latexName" class="label-success"></label>
            </div>
            -->
            <input type="text" id="layerName" class="form-control" placeholder="Layer name" onkeyup="update_shape_name()">
        </div>
        <div class="form-group">
            <label for="layerType" style="color:white">Layer Type</label>
            <select id="layerType" class="form-control selectpicker" onchange="select_layer_type(this)">
                <optgroup label="Data">
                    <option value="DataPlaceholder">Data Placeholder</option>
                </optgroup>
                <optgroup label="Preprocessing">
                    <option value="Whitening">Whitening</option>
                    <option value="Augmentation">Augmentation</option>
                </optgroup>
                <optgroup label="Layers">
                    <option value="Convolution">Convolution</option>
                    <option value="Pooling">Pooling</option>
                    <option value="InnerProduct">Inner Product</option>
                    <option value="Deconvolution">Deconvolution</option>
                    <option value="Activation">Activation</option>
                    <option value="Regularization">Regularization</option>
                    <option value="DataManipulation">Data Manipulation</option>
                    <option value="Normalization">Normalization</option>
                    <option value="ElementWise">Element-Wise</option>
                    <option value="Stochastic">Stochastic</option>
                    <option value="Recurrent">Recurrent</option>
                    <option value="SpecialBlock">Special Block</option>
                </optgroup>
                <optgroup label="Objectives">
                    <option value="Softmax">Softmax</option>
                    <option value="CategoricalCrossentropy">Categorical Crossentropy</option>
                    <option value="BinaryCrossentropy">Binary Crossentropy</option>
                    <option value="MeanSquareLoss">Mean Square Loss</option>
                    <option value="Hinge Loss">Hinge Loss</option>
                    <option value="L2Loss">L2 Loss</option>
                    <option value="L1Loss">L1 Loss</option>
                </optgroup>
            </select>
        </div>
        <hr class="separator">


        <!-- Data -->
        <div class="form-group" style="display: none;" id="dataParams">
            <label style="color:white; margin-bottom: 20px">Data Properties</label>
            <div class="row">
                <div class="col-lg-3">
                    <label for="dataWidth" style="color:white">Width</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="dataWidth" type="number" min="1" max="10000" value="1" style="width:70%;">
                </div>
                <div class="col-lg-3">
                    <label for="dataHeight" style="color:white">Height</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="dataHeight" type="number" min="1" max="10000" value="1" style="width:70%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-3">
                    <label for="dataDepth" style="color:white">Depth</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="dataDepth" type="number" min="1" max="10000" value="1" style="width:70%;">
                </div>
            </div>
        </div>

        <!-- Convolution -->
        <div class="form-group" style="display: none;" id="convolutionParams">
            <label style="color:white; margin-bottom: 20px">Kernel Properties</label>
            <div class="row">
                <div class="col-lg-3">
                    <label for="kernelWidth" style="color:white">Width</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="kernelWidth" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
                <div class="col-lg-3">
                    <label for="kernelHeight" style="color:white">Height</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="kernelHeight" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-3">
                    <label for="kernelStride" style="color:white">Stride</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="kernelStride" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
                <div class="col-lg-3">
                    <label for="kernelDilation" style="color:white">Dilation</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="kernelDilation" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-6">
                    <label for="numOfms" style="color:white">Number of OFMs</label>
                </div>
                <div class="col-lg-6" style="text-align: right; padding-right: 22px">
                    <input id="numOfms" type="number" min="1" max="100000" value="1" style="width:70%;">
                </div>
            </div>
        </div>


        <!-- Deconvolution -->
        <div class="form-group" style="display: none;" id="deconvolutionParams">
            <label style="color:white; margin-bottom: 20px">Kernel Properties</label>
            <div class="row">
                <div class="col-lg-3">
                    <label for="deconvKernelWidth" style="color:white">Width</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="deconvKernelWidth" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
                <div class="col-lg-3">
                    <label for="deconvKernelHeight" style="color:white">Height</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="deconvKernelHeight" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-3">
                    <label for="deconvKernelStride" style="color:white">Stride</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="deconvKernelStride" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-6">
                    <label for="deconvNumOfms" style="color:white">Number of OFMs</label>
                </div>
                <div class="col-lg-6" style="text-align: right; padding-right: 22px">
                    <input id="deconvNumOfms" type="number" min="1" max="100000" value="1" style="width:70%;">
                </div>
            </div>
        </div>

        <!-- InnerProduct -->
        <div class="form-group" style="display: none;" id="innerProductParams">
            <div class="row">
                <div class="col-lg-6">
                    <label for="innerProductNumOutputs" style="color:white">Output Size</label>
                </div>
                <div class="col-lg-6" style="padding:0; ">
                    <input id="innerProductNumOutputs" type="number" min="1" max="10000" value="1" style="width:70%;">
                </div>
            </div>
        </div>


        <!-- Pooling -->
        <div class="form-group " style="display: none;" id="poolingParams">
            <label for="poolingType" style="color:white">Pooling Type</label>
            <select id="poolingType" class="form-control selectpicker">
                <option value="Max">Max</option>
                <option value="Average">Average</option>
                <option value="Stochastic">Stochastic</option>
            </select>
            <br><br>
            <label style="color:white; margin-bottom: 20px">Window Properties</label>
            <div class="row">
                <div class="col-lg-3">
                    <label for="windowWidth" style="color:white">Width</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="windowWidth" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
                <div class="col-lg-3">
                    <label for="windowHeight" style="color:white">Height</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="windowHeight" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-3">
                    <label for="windowStride" style="color:white">Stride</label>
                </div>
                <div class="col-lg-3" style="padding:0">
                    <input id="windowStride" type="number" min="1" max="100" value="1" style="width:70%;">
                </div>
            </div>
        </div>


        <!-- Activation -->
        <div class="form-group" style="display: none;" id="activationParams">
            <label for="activationType" style="color:white">Activation Type</label>
            <select id="activationType" class="form-control selectpicker" onchange="select_layer_type()">
                <option value="ReLU">ReLU</option>
                <option value="ReLU6">ReLU6</option>
                <option value="LeakyReLU">Leaky ReLU</option>
                <option value="pReLU">Parametric ReLU</option>
                <option value="ELU">ELU</option>
                <option value="Sigmoid">Sigmoid</option>
                <option value="HardSigmoid">Hard Sigmoid</option>
                <option value="TanH">TanH</option>
                <option value="Softmax">Softmax</option>
                <option value="Softsign">Softsign</option>
                <option value="Softplus">Softplus</option>
            </select>
        </div>

        <!-- Normalization -->
        <div class="form-group" style="display: none;" id="normalizationParams">
            <label for="normalizationType" style="color:white">Normalization Type</label>
            <select id="normalizationType" class="form-control selectpicker" onchange="select_layer_type()">
                <option value="BatchNormalization">Batch Normalization</option>
                <option value="LocalResponseNormalization">Local Response Normalization</option>
                <option value="L2Normalization">L2 Normalization</option>
            </select>
        </div>

        <!-- Local Response Normalization -->
        <div class="form-group" style="display: none;" id="localResponseNormalizationParams">
            <div class="row">
                <div class="col-lg-8">
                    <label for="numberOfNeighbours" style="color:white">Number of Neighbours</label>
                </div>
                <div class="col-lg-4" style="text-align: right; padding-right: 15px">
                    <input id="numberOfNeighbours" type="number" min="1" max="100000" value="1" style="width:100%;">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-1">
                    <label for="K" style="color:white">K</label>
                </div>
                <div class="col-lg-2" style="padding:0">
                    <input id="K" type="number" min="1" max="100" value="1" style="width:100%;">
                </div>
                <div class="col-lg-1">
                    <label for="alpha" style="color:white">$\alpha$</label>
                </div>
                <div class="col-lg-3" style="padding:0; padding-left: 5px">
                    <input id="alpha" type="number" min="0" max="1" step="0.001" value="1" style="width:100%;">
                </div>
                <div class="col-lg-1">
                    <label for="beta" style="color:white">$\beta$</label>
                </div>
                <div class="col-lg-3" style="padding:0; padding-left: 5px">
                    <input id="beta" type="number" min="0" max="1" step="0.001" value="1" style="width:100%;">
                </div>
            </div>
            <br>
        </div>



        <!-- Regularization -->
        <div class="form-group" style="display: none;" id="regularizationParams">
            <label for="regularizationType" style="color:white">Regularization Type</label>
            <select id="regularizationType" class="form-control selectpicker" onchange="select_layer_type()">
                <option value="Dropout">Dropout</option>
                <option value="Maxout">Maxout</option>
                <option value="DropConnect">DropConnect</option>
                <option value="Zoneout">Zoneout</option>
            </select>
            <br><br>
            <div class="row">
                <div class="col-lg-6">
                    <label for="keepProbability" style="color:white">Keep Probability</label>
                </div>
                <div class="col-lg-6" style="text-align: right; padding-right: 22px">
                    <input id="keepProbability" type="number" min="0" max="1" value="1" style="width:70%;">
                </div>
            </div>
        </div>

        <!-- Data Manipulation -->
        <div class="form-group" style="display: none;" id="dataManipulationParams">
            <label for="reshapeType" style="color:white">Reshape Type</label>
            <select id="reshapeType" class="form-control selectpicker">
                <option value="Concatenate">Concatenate</option>
                <option value="Reshape">Reshape</option>
                <option value="Flatten">Flatten</option>
                <option value="Permute">Permute</option>
                <option value="Repeat">Repeat</option>
            </select>
        </div>

        <!-- Stochastic -->
        <div class="form-group" style="display: none;" id="stochasticParams">
            <label for="stochasticType" style="color:white">Stochastic Layer Type</label>
            <select id="stochasticType" class="form-control selectpicker">
                <option value="GaussianNoise">Gaussian Noise</option>
                <option value="UniformNoise">Uniform Noise</option>
                <option value="GumbleSoftmax">Gumble Softmax</option>
            </select>
        </div>

        <!-- Element-Wise -->
        <div class="form-group" style="display: none;" id="elementWiseParams">
            <label for="elementWiseOperator" style="color:white">Element-wise Operator</label>
            <select id="elementWiseOperator" class="form-control selectpicker">
                <option value="Add">Add</option>
                <option value="Multiply">Multiply</option>
            </select>
        </div>

        <!-- Special Block -->
        <div class="form-group" style="display: none;" id="specialBlockParams">
            <label for="specialBlockType" style="color:white">Block Type</label>
            <select id="specialBlockType" class="form-control selectpicker">
                <option value="Inception">Inception</option>
                <option value="ResidualBlock">Residual Block</option>
                <option value="DenseEncoder">Dense Encoder</option>
                <option value="DenseDecoder">Dense Decoder</option>
                <option value="ConvEncoder">Convolutional Encoder</option>
                <option value="ConvDecoder">Convolutional Decoder</option>
            </select>
        </div>


        <!-- Recurrent -->
        <div class="form-group" style="display: none;" id="recurrentParams">
            <label for="nodeType" style="color:white">Node Type</label>
            <select id="nodeType" class="form-control selectpicker">
                <option value="RNN">RNN</option>
                <option value="LSTM">LSTM</option>
                <option value="GRU">GRU</option>
            </select>
        </div>

        <div class="form-group">
            <label for="layerColor" style="color:white">Color</label>
            <div style="width:100%;cursor:pointer;" id="layerColor">
                <div class="layer-color" id="color0" onclick="change_color(0)"
                     style="background-color: rgb(142, 68, 173); border-top-left-radius: 3px;border-bottom-left-radius: 3px; ">
                    <i class="glyphicon glyphicon-ok"
                       style="margin-top: 3px;margin-left:50%;left:-8px;color:rgba(255,255,255,0.7)"></i>
                </div>
                <div class="layer-color" id="color1" onclick="change_color(1)"
                     style="background-color: rgb(52, 152, 219); ">
                </div>
                <div class="layer-color" id="color2" onclick="change_color(2)"
                     style="background-color: rgb(39, 174, 96); ">
                </div>
                <div class="layer-color" id="color3" onclick="change_color(3)"
                     style="background-color: rgb(241, 196, 15);">
                </div>
                <div class="layer-color" id="color4" onclick="change_color(4)"
                     style="background-color: rgb(230, 126, 34);">

                </div>
                <div class="layer-color" id="color5" onclick="change_color(5)"
                     style="background-color: rgb(231, 76, 60);border-top-right-radius: 3px;border-bottom-right-radius: 3px; border-style: none solid solid none;">
                </div>
            </div>
        </div>
        <br>
        <div class="form-group">
            <span style="padding-right: 5px; color:white"><b>Full Details</b></span>
            <div class="material-switch pull-right">
                <input id="fullDetails" name="latexName" type="checkbox" onchange="canvas_manager.show_full_details(this.checked)"/>
                <label for="fullDetails" class="label-success"></label>
            </div>
        </div>
        <div class="form-group" style="text-align:center;">
            <button type="button" id="addLayer" class="btn btn-default btn-circle btn-lg"
                    onclick="add_or_remove_layer()" style="outline:none;">
                <i data-toggle="tooltip" data-placement="top"
                     title="Add" id="addLayerIcon"
                     class="glyphicon glyphicon-plus"></i>
            </button>
        </div>
        <hr class="separator">
    </div>

    <div id="import_export" style="display: none">
        <div class="form-group">
            <label for="filename" style="color:white">Topology Name</label>
            <input type="text" id="filename" class="form-control" placeholder="Topology Name">
        </div>
        <div class="form-group">
            <label for="saveTopology" style="color:white">Save Topology Image</label>
            <button type="button" id="saveTopologyImage" class="form-control" onclick="save_current_state_as_image()">Save Image</button>
        </div>
        <div class="form-group">
            <label for="saveTopology" style="color:white">Neuralizer Data File</label>
            <button type="button" id="saveTopology" class="form-control" onclick="save_current_state_to_file()">Save Topology</button>
        </div>
        <div class="form-group">
            <button type="button" id="loadTopology" class="form-control" onclick="document.getElementById('fileInput').click()" style="margin-top:-10px">
                Load Topology
            </button>
            <input type="file" id="fileInput" style="display: none;">
        </div>
        <div class="form-group">
            <label for="framework" style="color:white">Export to Framework</label>
            <select id="framework" class="form-control selectpicker">
                <!--<option data-content="<img src='images/icon-neuralizer.png' style='margin-right:10px'>Neuralizer"-->
                <!--value="Neuralizer">Neuralizer-->
                <!--</option>-->
                <option data-content="<img src='images/icon-tensorflow.png' style='margin-right:10px'>TensorFlow"
                        value="TensorFlow">TensorFlow
                </option>
                <option data-content="<img src='images/icon-caffe.png' style='margin-right:10px'> Caffe" value="Caffe">
                    Caffe
                </option>
                <option data-content="<img src='images/icon-theano.png' style='margin-right:10px'> Theano"
                        value="Theano">Theano
                </option>
                <option data-content="<img src='images/icon-torch.png' style='margin-right:10px'> Torch" value="Torch">
                    Torch
                </option>
                <option data-content="<img src='images/icon-keras.png' style='margin-right:10px'> Keras" value="Keras">
                    Keras
                </option>
                <option data-content="<img src='images/icon-pytorch.png' style='margin-right:10px'> PyTorch"
                        value="Keras">PyTorch
                </option>
                <!--
                    <option data-content="<span style='width: 80px; display: inline-block'><img src='images/icon-tensorflow.png'></span>TensorFlow" value="TensorFlow">TensorFlow</option>
                    <option data-content="<span style='width: 80px; display: inline-block'><img src='images/icon-caffe.png'></span>Caffe" value="Caffe">Caffe</option>
                    <option data-content="<span style='width: 80px; display: inline-block'><img src='images/icon-theano.png'></span>Theano" value="Theano">Theano</option>
                    <option data-content="<span style='width: 80px; display: inline-block'><img src='images/icon-torch.png'></span>Torch" value="Torch">Torch</option>
                    <option data-content="<span style='width: 80px; display: inline-block'><img src='images/icon-keras.png'></span>Keras" value="Keras">Keras</option>
                    <option data-content="<span style='width: 80px; display: inline-block'><img src='images/icon-pytorch.png'></span>PyTorch" value="Keras">PyTorch</option>
                -->
            </select>
        </div>
        <div class="form-group">
            <button type="button" id="saveTopologyToFramework" class="form-control" onclick="">Save Topology</button>
        </div>

    </div>
    <div id="share_explore" style="display: none">
        <div class="form-group">
            <label style="color:white">Sharing Options</label>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <ul class="social-network social-circle">
                    <li>
                        <a href="#" class="icoFacebook" title="Facebook">
                            <i data-toggle="tooltip" data-placement="top" title="Share on Neuralizer" class="fa fa-facebook"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="icoTwitter" title="Twitter">
                            <i data-toggle="tooltip" data-placement="top" title="Share on Twitter" class="fa fa-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="icoGoogle" title="E-Mail" onclick="send_email()">
                            <i data-toggle="tooltip" data-placement="top" title="Send by email" class="fa fa-envelope"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="icoGitHub" title="GitHub Gist">
                            <i data-toggle="tooltip" data-placement="top" title="Share as Gist" class="fa fa-github"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <br>
        <div class="form-group">
            <label for="searchModels" style="color:white">Search Models</label>
            <div class="input-group">
                <input type="text" class="form-control" id="searchModels" placeholder="Model Name...">
                <span class="input-group-btn">
                <button class="btn btn-default" type="button"><span class="glyphicon glyphicon-search"></span></button>
              </span>
            </div><!-- /input-group -->
        </div>
        <div class="container" style="padding:0">
            <div class="row">
                <div class="col-md-3 ">
                    <div class="well" id="well2">
                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>AlexNet</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>Incpetion v3</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>ResNet</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>FCN</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>Faster-RCNN</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>AlexNet</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6 col-md-12">
                                <a href="#" class="thumbnail ModelItem">
                                    <div class="ModelItemContent">
                                        <b>AlexNet</b>
                                        <br>
                                        Author: Itai Caspi
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="account">

    </div>
</div>
<div class="col-xs-9" style="height:100%">
    <div id="canvas_keys">

    </div>
    <div id="canvas_overlay">
        <div id="canvas_messages">
            <h1>Copied to clipboard</h1>
        </div>
    </div>
    <canvas id="cnv" width="100%" height="100%"></canvas>
</div>
<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap-select.js"></script>
<script>
    $(document).ready(function () {
        // Initiate with custom caret icon
        $('select.selectpicker').selectpicker();
        // Initiate tooltip
        $('[data-toggle="tooltip"]').tooltip();

        select_layer_type();
    });
</script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-91199634-1', 'auto');
    ga('send', 'pageview');
</script>
</body>
</html>